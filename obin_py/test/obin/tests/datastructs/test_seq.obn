import affirm
import list
import seq

fun test () ->
    l1 = list:range 0 10
    affirm:is_equal (seq:concat [0,1,2,3,4,5] [6,7,8,9]) l1
    affirm:is_equal (seq:concat [] l1) l1
    affirm:is_equal (seq:concat l1 []) l1
    affirm:is_equal (seq:concat [] []) []
    affirm:is_equal (seq:reverse l1) [9,8,7,6,5,4,3,2,1,0]

    affirm:is_true (seq:prefix_of [1,2,3,4] [1,2,3,4,5,6])
    affirm:is_false (seq:prefix_of [0,1,2,3,4] [1,2,3,4,5,6])
    affirm:is_false (seq:prefix_of [1,2,3,4] [1,2,3,5,4,6])

    affirm:is_true (seq:suffix_of [4,5,6] [1,2,3,4,5,6])
    affirm:is_false (seq:suffix_of [3,5,6] [1,2,3,4,5,6])
    affirm:is_false (seq:suffix_of [4,5,6] [1,2,3,4,6,5])

    affirm:is_equal (seq:drop 3 l1) [3,4,5,6,7,8,9]
    affirm:is_equal (seq:map lam x -> x+1 end l1) [1,2,3,4,5,6,7,8,9,10]
    affirm:is_equal (seq:intersperse 0 l1) [0,0,1,0,2,0,3,0,4,0,5,0,6,0,7,0,8,0,9,0]
    affirm:is_equal (seq:scanl `+` 0 (list:range 1  11))  [0, 1, 3, 6, 10, 15, 21, 28, 36, 45, 55]

    affirm:is_equal (seq:last l1) 9
    affirm:is_equal (seq:init l1) [0, 1, 2, 3, 4, 5, 6, 7, 8]
    affirm:is_equal (seq:take 3 l1) [0,1,2]
    affirm:is_equal (seq:split_at 3 l1)  ([0, 1, 2], [3, 4, 5, 6, 7, 8, 9])
    affirm:is_equal (seq:take_while lam x -> x < 5 end l1) [0, 1, 2, 3, 4]
    affirm:is_equal (seq:drop_while lam x -> x < 5 end l1) [5, 6, 7, 8, 9]
    affirm:is_equal (seq:span lam x -> x < 3 end [1,2,3,4,1,2,3,4]) .
                    ([1, 2], [3, 4, 1, 2, 3, 4])

    affirm:is_equal (seq:span lam x -> x < 9 end [1,2,3]) .
                    ([1, 2, 3], [])

    affirm:is_equal (seq:span lam x -> x < 0 end [1,2,3]) .
                    ([], [1, 2, 3])

    affirm:is_true (seq:conjunction [True, True, True, True])
    affirm:is_false (seq:conjunction [True, True, True, False])
    affirm:is_true (seq:all lam x -> x < 7 end  [0,1,2,3,4,5,6])
    affirm:is_false (seq:all lam x -> x < 3 end  [0,1,2,3,4,5,6])
    affirm:is_true (seq:any lam x -> x < 7 end  [0,1,2,3,4,5,6])
    affirm:is_true (seq:any lam x -> x < 3 end  [0,1,2,3,4,5,6])
    affirm:is_false (seq:any lam x -> x < -1 end  [0,1,2,3,4,5,6])

    affirm:is_equal (seq:delete 8 l1) [0,1,2,3,4,5,6,7,9]

//    print (
//        (seq:conjunction [True, True, True, True]),
//    )


//    span (< 3) [1,2,3,4,1,2,3,4] == ([1,2],[3,4,1,2,3,4])
//span (< 9) [1,2,3] == ([1,2,3],[])
//span (< 0) [1,2,3] == ([],[1,2,3])
