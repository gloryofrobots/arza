import arza:lang:_api
import arza:lang:_datatype

def repr (self of Any) = str(self)

def < (x of Comparable, y) = cmp(x, y) == LT
def >= (x of Comparable, y) = cmp(x, y) != LT
def > (x of Comparable, y) = cmp(x, y) == GT

def cmp (x of LessEq, y) =
            if x == y then EQ
            elif x <= y then LT
            else GT

def max (x of LessEq, y) = if x <= y then y else x
def min (x of LessEq, y) = if x <= y then x else y


/////////////////////////////

import arza:lang:_generic

def at (k, self of Map) as _api:at
def at (el, self of Tuple) as _api:at
def at (t, self of Generic) as _generic:get_method

/////////////////////////////////////////////

let Behavior =
{
    //Eq
    (`!=`) = (x, y) -> not (x == y),

    (`==`) = (self, other) -> _api:equal(other, self),

    (str) = (self) -> _api:to_string(self),

    (repr) = (self) -> _api:to_repr(self),

    (put) = (key, value, self) -> _api:put(key, value, self),
    (at) = (key, self) -> _api:at(key, self),
    (del) = (key, self) -> _api:del(key, self),
    (elem) = (key, self) -> _api:elem(key, self),

    (len) = (self) -> _api:length(self),
    (is_empty) = (self) -> _api:is_empty(self)
}

derive (Eq, PartialEq, Str, Displayed) for (
                                            Function,
                                            Generic,
                                            Partial,
                                            Datatype,
                                            Bool,
                                            Interface)
