import io
import affirm
import seq
import list
import array
import string
import process
//import tests
import tests:test_process


fun coro(fn, ...args) =
    let
        proc1 = self()
        proc2 = process:create()
        fun return() =
            let
                result = fn()
            in
                process:resume(proc1)

        fun yield(val) =
            process:pause(proc2)
            proc1 ! val
            process:resume(proc1)

        fun _coro(val) =
            process:pause(proc1)
            if process:is_idle(proc2) then
               process:start(proc2, return, args)
            elif process:is_finished(proc2) then
                process:result(proc2)
            else
                process:resume(proc2)

fun main() =
    ()
//    test_process:test()
//    test_simple()
//    tests:run()
