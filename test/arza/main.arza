//import io
//import affirm
//import seq
//import list
//import array
//import string
//import tests

fun receive(fn) =
    if __has__(self()) == False then
        __wait__(self())
        receive(fn)
    else
        let msg = __pop__(self())
        in fn(msg)

fun r(x)
    | 1 = PL(#one)
    | 2 = PL(#two)

fun f1() =
    receive(r)
    f1()



fun main() =
    let
        p1 = process(f1, ())
    in
        DMARK(21)
        p1(1)
        p1(2)
        p1(1)
        p1(1)
        p1(2)
        p1(3)
//        p1(1)
//    tests:run()
