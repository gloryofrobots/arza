import lalan:lang:_tuple
import string
import derive

extend Tuple (
    use derive:TEq
    use derive:TCollection
    use derive:TSized
    use TRepr

    let ++ = _tuple:concat
    let prepend = _tuple:prepend
    let to_seq = _tuple:to_list
    let slice = _tuple:slice
    let drop = _tuple:drop
    let take = _tuple:take

    def str(self) =
        if len(self) == 1 then
            "(" ++ repr(at(0, self)) ++ ",)"
        else
            "(" ++ string:join_with(repr, to_seq(self), ", ") ++ ")"
)

fun split
    | ((x)) = (x, ())
    | ((x, ...rest)) = (x, rest)
